<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>19.2. Hashing Passwords &#8212; Java Web Development  documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/site.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="19.3. Creating a User Model" href="user-model.html" />
    <link rel="prev" title="19.1. Introduction to Authentication" href="intro.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body class="body-bc">

<div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
        </a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<ol class="breadcrumb container">
    <li><a href="../../index.html">Contents</a></li>
    <li><a href="index.html"><span class="section-number">19. </span>Authentication</a></li>
    <li class="active"><span class="section-number">19.2. </span>Hashing Passwords</li>
</ol>



<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1 content " role="main">

    
  <div class="section" id="hashing-passwords">
<span id="id1"></span><h1><span class="section-number">19.2. </span>Hashing Passwords<a class="headerlink" href="#hashing-passwords" title="Permalink to this headline">¶</a></h1>
<p id="index-0">Simple authentication allows users to log in to a site with a username and password. To implement authentication, we need to be able to verify that a user’s password is correct. However, <strong>you should NEVER store passwords in a database.</strong> Seriously. Don’t do it. Ever.</p>
<p>Storing passwords in a database is incredibly insecure. A hacker may break into the database, gaining access to every user account. Or a deviant employee with access to the database may do the same.</p>
<p>Fortunately, it is possible for us to implement simple authentication <em>without</em> storing passwords, by using a technique called <strong>password hashing</strong>. Password hashing is a particular type of encryption that we will explore throughout the rest of this section.</p>
<div class="section" id="two-way-encryption">
<h2><span class="section-number">19.2.1. </span>Two-Way Encryption<a class="headerlink" href="#two-way-encryption" title="Permalink to this headline">¶</a></h2>
<p id="index-1">When you think of encryption, you might think of WWII or the Cold War, when the militaries of various countries exchanged secret messages that were unreadable by their enemies. This type of encryption is <strong>two-way encryption</strong>. A message is <em>encoded</em> with a key before being sent, and when it is received, it is <em>decoded</em> by another key.</p>
<div class="figure align-default" id="id2">
<img alt="A two-way encryption flow. A key is used to encrypt sensitive data. After being transmitted, another key decrypts it." src="../../_images/two-way-encryption.png" />
<p class="caption"><span class="caption-text">Two-way encryption (Created by Munkhzaya Ganbold, licensed via <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" target="_blank">CC BY-SA<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>)</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="one-way-encryption">
<h2><span class="section-number">19.2.2. </span>One-Way Encryption<a class="headerlink" href="#one-way-encryption" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-2"></span><p id="index-3"><strong>One-way encryption</strong>, also known as <strong>hashing</strong>, encodes a message in a way that makes it <em>nearly</em> impossible to decode. An algorithm implementing a one-way encryption algorithm is a <strong>cryptographic hash function</strong> (we’ll usually leave off “cryptographic”). For a specific message, the output of a hash function is a <strong>hash</strong>.</p>
<p>The hashing process is essentially just the top half of the diagram above. While it might not be clear yet, hashing allows us to securely store passwords and still be able to validate a user’s submitted password. Precisely <em>how</em> this is done will be explored in a moment.
The diagram below shows the general flow of how hashing works to secure the site.</p>
<div class="figure align-default" id="id3">
<img alt="Diagram showing how encoded passwords are compared to a submitted password to authenticate a user." src="../../_images/hashingdiagram.png" />
<p class="caption"><span class="caption-text">Diagram showing how encoded passwords are compared to a submitted password to authenticate a user.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>It can be difficult to write a good hash function, so thankfully you will never have to. Over the years, some very smart people have created some very good hash functions. However, it is important to understand how the properties of a hash function allow for secure password storage. For our purposes, it is only important that we consider a hash function to have these properties:</p>
<ol class="arabic simple" id="hash-properties">
<li><strong>Deterministic</strong>: If we encode a message with the function at different points in time then we always get the same result.</li>
<li><strong>Hard to reverse</strong>: It is infeasible to calculate the input value that yields a given hash.</li>
<li><strong>Hash values are ALMOST unique</strong>: If <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are two different messages, then is is <em>extremely</em> unlikely that they have the same hash value. By “extremely unlikely” we mean that this is something like a one-in-a-trillion likelihood (for example, there are only about 8 billion people on earth).</li>
<li><strong>Similar messages have VERY different hash values</strong>: In other words, if we change a message only slightly, the resulting hash value is <em>very</em> different. A function that returned <code class="docutils literal notranslate"><span class="pre">AlXL3M_ws</span></code> for the message <code class="docutils literal notranslate"><span class="pre">&quot;LaunchCode&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">AlXL3M_wt</span></code> for the message <code class="docutils literal notranslate"><span class="pre">&quot;LaunchCodf&quot;</span></code> would not be a suitable hash function.</li>
</ol>
</div>
<div class="section" id="password-verification-with-hashes">
<h2><span class="section-number">19.2.3. </span>Password Verification With Hashes<a class="headerlink" href="#password-verification-with-hashes" title="Permalink to this headline">¶</a></h2>
<p>Our application will select a particular hash function. Let’s call it <code class="docutils literal notranslate"><span class="pre">h</span></code>. Then, for a message <code class="docutils literal notranslate"><span class="pre">x</span></code>, the hash value will be the result of calling <code class="docutils literal notranslate"><span class="pre">h</span></code> with the argument <code class="docutils literal notranslate"><span class="pre">x</span></code>. Invoked, this looks like <code class="docutils literal notranslate"><span class="pre">h(x)</span></code>.  Rather than store passwords in a database, we will store their hash values.</p>
<p>Consider a fictional user that wants to sign up for our site, Jamie. Jamie likes Taylor Swift, so their desired username is <code class="docutils literal notranslate"><span class="pre">tswizzle_fan</span></code> and their desired password is <code class="docutils literal notranslate"><span class="pre">lover1989</span></code> (not a great password choice, by the way, but we’ve seen worse).</p>
<p>When Jamie registers for an account on our site, we will call our hash function with their password:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="s">&quot;lover1989&quot;</span><span class="p">);</span> <span class="c1">// returns &quot;bd62d7e13ef465fa705f30de198ba0cb&quot;</span>
</pre></div>
</td></tr></table></div>
<p>Then we store Jamie’s username along with her hashed password in our <code class="docutils literal notranslate"><span class="pre">user</span></code> table.</p>
<table border="1" class="docutils align-default">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">username</th>
<th class="head">passwordHash</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>tswizzle_fan</td>
<td>bd62d7e13ef465fa705f30de198ba0cb</td>
</tr>
</tbody>
</table>
<p>This is very secure. Even if somebody breaks into the database and finds Jamie’s info, they will not be able to log in. Since we used a hash function, the hacker will have a very hard time turning the hash into a password (see <a class="reference internal" href="#hash-properties"><span class="std std-ref">property 2</span></a>).</p>
<p>We can still authenticate Jamie, however. When they come to our site to log in, they will submit a username and password. Let’s call the password value <code class="docutils literal notranslate"><span class="pre">submittedPassword</span></code>. Some basic logic will allow us to determine, with an <em>extremely</em> high rate of probability, whether or not the pair is valid.</p>
<p>To check Jamie’s username/password pair, we can do something like this:</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// fetches Jamie&#39;s user object from the database</span>
<span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">getUserByUsername</span><span class="p">(</span><span class="s">&quot;tswizzle_fan&quot;</span><span class="p">);</span>

<span class="c1">// gets the hash value stored on their object</span>
<span class="n">String</span> <span class="n">passwordHash</span> <span class="o">=</span> <span class="n">user</span><span class="p">.</span><span class="na">getPasswordHash</span><span class="p">();</span>

<span class="c1">// hashes the submitted password</span>
<span class="n">String</span> <span class="n">submittedHash</span> <span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="n">submittedPassword</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">passwordHash</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">submittedHash</span><span class="p">))</span> <span class="p">{</span>
   <span class="c1">// the hashes are the same, the passwords can be assumed to be the same</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="c1">// the hashes are different, so the passwords are definitely different</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The conditional compares the values of the hash stored in the database with the hash generated from the <em>submitted</em> password. By <a class="reference internal" href="#hash-properties"><span class="std std-ref">property 1</span></a>, we know that if the hash values are different, then there is no way the passwords are the same. By <a class="reference internal" href="#hash-properties"><span class="std std-ref">property 3</span></a>, we can safely assume that the passwords are the same.</p>
<div class="section" id="hashing-isn-t-perfect">
<h3><span class="section-number">19.2.3.1. </span>Hashing Isn’t Perfect<a class="headerlink" href="#hashing-isn-t-perfect" title="Permalink to this headline">¶</a></h3>
<p id="index-4">Using hash functions to process passwords is not a cure-all. One vulnerability is the possibility for <strong>collisions</strong>. A collision occurs when two different messages have the same hash value. By <a class="reference internal" href="#hash-properties"><span class="std std-ref">property 3</span></a>, this is supposed to be rare. However, if a collision is found for a given hash function, then it may be possible to create an algorithm to <em>generate</em> collisions. In other words, given a specific hash value, the algorithm could generate a string with the <em>same</em> hash value.</p>
<p id="index-5">The once-popular MD5 and SHA1 hash algorithms <a class="reference external" href="https://arstechnica.com/information-technology/2017/02/at-deaths-door-for-years-widely-used-sha1-function-is-now-dead/" target="_blank">quickly become obsolete<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> (for cryptographic purposes, at least) once collisions were found.</p>
<p>Most hashing algorithms become more vulnerable as global computing power increases. If a hacker breaks into a database, they will obtain the hashes of all of its users’ passwords. Since only a small handful of hash functions are commonly used, they might simply try millions of strings with each of the more popular hash functions and wait until they find a match.</p>
<div class="admonition-note admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p>The widespread use of brute force attacks is why it is always a bad idea to use a password that:</p>
<ul class="simple">
<li>is ranked as one of the <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_the_most_common_passwords" target="_blank">most commonly used passwords<i class="fas fa-external-link-alt" aria-hidden="true"></i></a></li>
<li>utilizes publicly accessible information about you, such as birth date or address</li>
<li>uses common words from the dictionary</li>
</ul>
<p class="last">When trying to crack a password hash using brute force, these are the first items a hacker will attempt to use.</p>
</div>
</div>
</div>
<div class="section" id="which-hash-function-should-i-use">
<h2><span class="section-number">19.2.4. </span>Which Hash Function Should I Use?<a class="headerlink" href="#which-hash-function-should-i-use" title="Permalink to this headline">¶</a></h2>
<p id="index-6">You should use <a class="reference external" href="https://en.wikipedia.org/wiki/Bcrypt" target="_blank">bcrypt<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>. This hash function is considered not only the best hash function at the moment, but also likely to be able to stand the test of time. Bcrypt uses hashing best practices (such as <a class="reference external" href="https://en.wikipedia.org/wiki/Salt_(cryptography)" target="_blank">salts<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>) along with an algorithm that can be made to run as long as you like. So even as computing power grows, bcrypt will be resistant to brute force techniques.</p>
</div>
<div class="section" id="check-your-understanding">
<h2><span class="section-number">19.2.5. </span>Check Your Understanding<a class="headerlink" href="#check-your-understanding" title="Permalink to this headline">¶</a></h2>
<div class="admonition-question admonition">
<p class="first admonition-title"><i class="fas fa-question" aria-hidden="true"></i>Question</p>
<p>True/False: One-way encryption does not involve decryption.</p>
<ol class="last arabic simple">
<li>True</li>
<li>False</li>
</ol>
</div>
<div class="admonition-question admonition">
<p class="first admonition-title"><i class="fas fa-question" aria-hidden="true"></i>Question</p>
<p>Which of the following best describes hashing?</p>
<ol class="last arabic simple">
<li>Hashing is the process of encrypting plaintext so that it is very difficult to obtain the original message.</li>
<li>Hashing is more secure than two-way encryption but less useful because it does not decode an encoded message.</li>
<li>Hashing cannot confirm that two passwords are the same because the original values are never saved.</li>
<li>Hashing smashing.</li>
</ol>
</div>
</div>
</div>



    
    <nav aria-label="Next and Previous Pages">
      <ul class="pager">
        
        <li class="previous"><a href="intro.html"><span aria-hidden="true">&larr;</span> <span class="section-number">19.1. </span>Introduction to Authentication</a></li>
        
        
        <li class="next"><a href="user-model.html"><span class="section-number">19.3. </span>Creating a <code class="docutils literal notranslate"><span class="pre">User</span></code> Model <span aria-hidden="true">&rarr;</span></a></li>
        
      </ul>
    </nav>
    
    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/chapters/auth/hashing-passwords.rst.txt"
     rel="nofollow">Page Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>